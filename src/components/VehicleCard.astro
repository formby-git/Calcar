---

---

<div id="vehicle-card" class="relative hidden mb-8">
  <!-- Breakout Container -->
  <div
    class="-mx-6 md:-mx-12 lg:-mx-20 bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden transform transition-all duration-300"
  >
    <!-- Dynamic Vehicle Image -->
    <div
      id="image-wrapper"
      class="relative h-48 md:h-72 bg-slate-200 hidden group"
    >
      <img
        id="vehicle-image"
        class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
        src=""
        alt="Vehicle Preview"
      />
      <div
        class="absolute inset-0 bg-gradient-to-t from-slate-900/60 to-transparent"
      >
      </div>
    </div>

    <div class="grid md:grid-cols-2">
      <!-- Col 1: Identity -->
      <div class="p-8 md:p-10 flex flex-col justify-center">
        <div class="mb-6">
          <h3
            class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-1"
          >
            Make & Model
          </h3>
          <div class="text-3xl font-extrabold text-slate-900 leading-tight">
            <span id="val-make" class="block"></span>
            <span id="val-model" class="className text-blue-600"></span>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-6">
          <div>
            <p
              class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1"
            >
              Year
            </p>
            <p class="font-medium text-lg text-slate-700" id="val-year">-</p>
          </div>
          <div>
            <p
              class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-1"
            >
              Colour
            </p>
            <p class="font-medium text-lg text-slate-700" id="val-colour">-</p>
          </div>
        </div>
      </div>

      <!-- Col 2: Efficiency (Darker/Contrast) -->
      <div
        class="bg-slate-50 p-8 md:p-10 border-t md:border-t-0 md:border-l border-slate-100 flex flex-col justify-center"
      >
        <h3
          class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-6"
        >
          Efficiency Specs
        </h3>

        <div class="space-y-6">
          <div>
            <p class="text-sm text-slate-500 mb-1">Fuel Type</p>
            <p class="font-medium text-xl text-slate-900" id="val-fuel">-</p>
          </div>
          <div>
            <p class="text-sm text-slate-500 mb-1">CO2 Emissions</p>
            <div class="flex items-center gap-2">
              <p class="font-medium text-xl text-slate-900" id="val-co2">-</p>
              <span
                class="text-xs px-2 py-0.5 rounded-full bg-slate-200 text-slate-600 font-mono"
                >g/km</span
              >
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  import type { Car } from "../utils/carService";
  import { fetchCarImage } from "../utils/wikiImageService";

  const card = document.getElementById("vehicle-card");
  const imageWrapper = document.getElementById("image-wrapper");
  const vehicleImage = document.getElementById(
    "vehicle-image",
  ) as HTMLImageElement;

  window.addEventListener("car-loaded", (async (e: CustomEvent<Car>) => {
    const car = e.detail;
    if (!card) return;

    // Update fields
    setText("val-make", car.make);
    setText("val-model", car.model);
    setText("val-fuel", car.fuelType);
    setText("val-year", car.yearOfManufacture.toString());
    setText("val-co2", car.co2Emissions.toString());
    setText("val-colour", car.colour);

    card.classList.remove("hidden");

    // Reset image state
    if (imageWrapper) imageWrapper.classList.add("hidden");

    // Fetch Image
    if (imageWrapper && vehicleImage) {
      const imageUrl = await fetchCarImage(car.make, car.model);
      if (imageUrl) {
        vehicleImage.src = imageUrl;
        imageWrapper.classList.remove("hidden");
      }
    }
  }) as unknown as EventListener);

  function setText(id: string, text: string) {
    const el = document.getElementById(id);
    if (el) el.textContent = text;
  }
</script>
